<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Escape Lithuania ‚Äì The Baltic Quest (v2)</title>
<style>
  :root{
    --lt-green:#006a44;
    --lt-yellow:#fdb913;
    --lt-red:#c1272d;
    --bg:#0f0f12;
    --card:#17181c;
    --text:#f1f5f9;
    --muted:#a8b0bb;
    --accent:#60a5fa;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji";
    background:linear-gradient(135deg,#0b1220,#0d0e12 60%,#14161a);color:var(--text);line-height:1.5}
  header{padding:20px 16px;display:flex;align-items:center;gap:12px;border-bottom:1px solid #22252b;position:sticky;top:0;background:rgba(13,14,18,.8);backdrop-filter:blur(8px);z-index:5}
  .flag{width:22px;height:22px;border-radius:2px;display:inline-grid;grid-auto-rows:1fr;overflow:hidden;border:1px solid #222}
  .flag>i{display:block}.flag .g{background:var(--lt-green)}.flag .y{background:var(--lt-yellow)}.flag .r{background:var(--lt-red)}
  h1{font-size:clamp(20px,2.6vw,28px);margin:0}
  main{max-width:900px;margin:0 auto;padding:24px 16px 60px}
  .card{background:var(--card);border:1px solid #23262e;border-radius:16px;padding:22px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
  .hero{text-align:center;padding:28px 16px;background:radial-gradient(1200px 500px at 50% -10%, rgba(96,165,250,.2), transparent);border:1px dashed #273042;border-radius:16px}
  .hero h2{font-size:clamp(22px,3.2vw,36px);margin:8px 0 10px}
  .hero p{color:var(--muted);max-width:720px;margin:0 auto 18px}
  button{appearance:none;border:0;background:linear-gradient(135deg,var(--lt-green),#0ea061);color:#fff;padding:12px 18px;border-radius:12px;font-weight:700;cursor:pointer;box-shadow:0 8px 16px rgba(0,0,0,.25)}
  button[disabled]{opacity:.6;cursor:not-allowed}
  .secondary{background:#272b33}
  .danger{background:linear-gradient(135deg,var(--lt-red),#ff4d4f)}
  .neutral{background:#1f2229}
  .grid{display:grid;gap:18px}
  .qimg{width:100%;aspect-ratio:16/9;object-fit:cover;border-radius:12px;border:1px solid #2a2f39;background:#0f1115}
  .question h3{margin:10px 0 8px;font-size:clamp(18px,2.4vw,24px)}
  .options{display:grid;gap:10px;margin:10px 0 4px}
  .opt{display:flex;align-items:center;gap:12px;padding:12px 14px;border-radius:12px;border:1px solid #2a2f39;background:#1a1c21;cursor:pointer;transition:.15s transform,.15s background,.15s border}
  .opt:hover{transform:translateY(-1px);background:#1d2026}
  .opt input{accent-color:var(--lt-yellow);width:18px;height:18px}
  .meta{display:flex;gap:14px;flex-wrap:wrap;align-items:center;color:var(--muted);font-size:14px}
  .badge{padding:6px 10px;border-radius:999px;border:1px solid #2a2f39;background:#15161a}
  .controls{display:flex;gap:12px;justify-content:space-between;align-items:center;margin-top:10px}
  .hints{display:grid;gap:6px;margin-top:10px}
  .hint{font-size:14px;color:#cbd5e1;opacity:.9}
  .hint.hidden{display:none}
  .lock{color:#ffadad;font-weight:700}
  .progress{height:10px;background:#1b1e24;border-radius:999px;border:1px solid #2a2f39;overflow:hidden}
  .bar{height:100%;width:0%;background:linear-gradient(90deg,var(--lt-green),var(--lt-yellow),var(--lt-red));transition:width .4s}
  .timer{font-variant-numeric:tabular-nums}
  footer{margin-top:18px;color:var(--muted);font-size:12px;text-align:center}
  .celebrate{position:fixed;inset:0;pointer-events:none;z-index:10}
  .confetti{position:absolute;width:8px;height:14px;opacity:.9;border-radius:2px;animation:fall linear forwards}
  @keyframes fall{0%{transform:translateY(-10vh) rotate(0deg)}100%{transform:translateY(110vh) rotate(720deg)}}
</style>
</head>
<body>
<header>
  <span class="flag"><i class="g"></i><i class="y"></i><i class="r"></i></span>
  <h1>Escape Lithuania ‚Äì The Baltic Quest</h1>
  <div style="margin-left:auto" class="meta">
    <span class="badge">Teams: 5</span>
    <span class="badge timer">Time: 10:00</span>
    <span class="badge">Hints: 1 per 30s (max 3)</span>
  </div>
</header>
<main>
  <section id="screen-start" class="card hero">
    <h2>Survive if you can üá±üáπ</h2>
    <p>You‚Äôre trapped in the land of forests, pink soup, and basketball. Solve 6 challenges to escape. First country to finish wins <b>Pergalƒó</b> (Victory) chocolate.</p>
    <div class="meta" style="justify-content:center">
      <span class="badge">Multiple choice</span>
      <span class="badge">Wrong answer lock: 30s</span>
      <span class="badge">Real photos (local /images)</span>
    </div>
    <div style="margin-top:14px">
      <button id="btn-start">Start Game</button>
    </div>
  </section>

  <section id="screen-quiz" class="grid" style="display:none">
    <div class="card">
      <div class="progress"><div id="progress-bar" class="bar"></div></div>
      <div class="meta" style="margin-top:10px">
        <span class="badge">Question <span id="qnum">1</span>/6</span>
        <span class="badge timer">Section Time: <span id="section-timer">00:00</span></span>
        <span id="hint-status" class="badge">Hint available in 00:30</span>
      </div>
    </div>

    <div class="card question">
      <img id="qimg" class="qimg" alt="Question image">
      <h3 id="qtitle">Question title</h3>
      <div id="qtext" style="color:var(--muted); margin:6px 0 10px"></div>
      <div id="options" class="options"></div>
      <div class="controls">
        <div class="meta">
          <span class="badge">Status: <b id="status">‚Äî</b></span>
          <span id="lockmsg" class="lock" style="display:none"></span>
        </div>
        <div>
          <button id="btn-hint" class="secondary" disabled>Reveal hint</button>
          <button id="btn-next" disabled>Next ‚Üí</button>
        </div>
      </div>
      <div id="hints" class="hints"></div>
    </div>
  </section>

  <section id="screen-end" class="card hero" style="display:none">
    <h2>You Escaped Lithuania! üéâ</h2>
    <p>Congratulations! You‚Äôve completed the Baltic Quest. Say <b>‚ÄúSveiki!‚Äù</b> proudly and enjoy your <b>Pergalƒó</b> (Victory) chocolate. üì∏ Bonus: team photo doing the Iron Wolf pose üê∫</p>
    <div style="display:flex; gap:10px; justify-content:center">
      <button id="btn-restart" class="neutral">Play again</button>
      <button id="btn-celebrate" class="danger">Celebrate!</button>
    </div>
    <footer>Made for Erasmus ‚Äì real places, real culture.</footer>
  </section>
</main>

<canvas id="fx" class="celebrate"></canvas>

<script>
/* ===== GAME DATA =====
   Images now use local paths under /images/ .
   Upload the following files to your repo:
   images/gediminas.jpg
   images/six.png
   images/pergale.jpg
   images/crosses.jpg
   images/saltibarsciai.jpg
   images/balticway.jpg
*/
const QUESTIONS = [
  {
    title: "The Dream of the Iron Wolf",
    text: "A castle on a hill, two rivers below, and a city born from a dream about a howling metal wolf. What city is this?",
    image: "images/gediminas.jpg",
    options: ["Kaunas","Vilnius","Klaipƒóda","Riga"],
    correct: 1,
    hints: [
      "It‚Äôs the capital city of Lithuania.",
      "Gediminas had a dream about a wolf.",
      "Vilnius."
    ],
  },
  {
    title: "Tongue Twister",
    text: "Say this Lithuanian tongue twister correctly: ‚Äú≈†e≈°i ≈æƒÖsinai ≈æarstƒó ≈æirnius ≈ævirbliams.‚Äù What does the first word ‚Äú≈†e≈°i‚Äù mean in English?",
    image: "images/six.png",
    options: ["Six","Goose","Beans","Fast"],
    correct: 0,
    // Order improved: from vaguer to specific
    hints: [
      "Comes before seven.",
      "It‚Äôs a number.",
      "Six."
    ],
  },
  {
    title: "Sweet Victory",
    text: "One of these famous Lithuanian chocolates means ‚ÄúVictory‚Äù. Which one?",
    image: "images/pergale.jpg",
    options: ["Grilia≈æas","Karvutƒó","Pergalƒó","Laima"],
    correct: 2,
    hints: ["Think about winners.","Starts with ‚ÄúP‚Äù.","Pergalƒó."],
  },
  {
    title: "The Hill of Crosses",
    text: "This sacred hill in Lithuania has over 100,000 wooden crosses ‚Äî a symbol of freedom and faith. What‚Äôs its name?",
    image: "images/crosses.jpg",
    options: ["The Hill of Crosses","Freedom Hill","Miracle Hill","Mount Hope"],
    correct: 0,
    hints: ["Sacred hill.","Thousands of crosses.","Hill of Crosses."],
  },
  {
    title: "The Pink Soup",
    text: "It‚Äôs cold, pink, and made with beets and kefir. Foreigners fear it. Lithuanians love it. What‚Äôs it called?",
    image: "images/saltibarsciai.jpg",
    options: ["Cepelinai","≈†altibar≈°ƒçiai","Pink Curry","Strawberry Soup"],
    correct: 1,
    hints: ["It‚Äôs a soup.","It‚Äôs cold.","≈†altibar≈°ƒçiai."],
  },
  {
    title: "The Baltic Way",
    text: "In 1989, almost two million people held hands forming a human chain across three Baltic countries ‚Äî Lithuania, Latvia, and Estonia. What was this peaceful protest called?",
    image: "images/balticway.jpg",
    options: ["The Freedom Line","The Baltic Way","The Human Bridge","The Baltic Chain"],
    correct: 1,
    hints: [
      "It united three Baltic nations.",
      "Around 600 km long human chain.",
      "The Baltic Way."
    ],
  },
];

/* ===== STATE ===== */
let idx = 0;
let lockedUntil = 0;      // timestamp for wrong answer lock
let sectionStart = 0;
let revealedHints = 0;
let totalStart = 0;
let rafId = null;
let nextHintAt = 0;       // timestamp when next hint can be revealed

/* ===== HELPERS ===== */
const $ = (sel)=>document.querySelector(sel);
const el = (tag, cls)=>{const e = document.createElement(tag); if(cls) e.className = cls; return e;};
function fmt(ms){
  const s = Math.max(0, Math.floor(ms/1000));
  const m = Math.floor(s/60).toString().padStart(2,'0');
  const ss = (s%60).toString().padStart(2,'0');
  return `${m}:${ss}`;
}
function setProgress(){
  const p = ((idx)/QUESTIONS.length)*100;
  $("#progress-bar").style.width = p+"%";
  $("#qnum").textContent = idx+1;
}

/* ===== HINT LOGIC (cooldown & cap) ===== */
function resetHints(){
  revealedHints = 0;
  const box = $("#hints");
  box.innerHTML = "";
  const q = QUESTIONS[idx];
  q.hints.forEach((h,i)=>{
    const d = el("div","hint hidden"); d.textContent = `Hint ${i+1}: ${h}`; box.appendChild(d);
  });
  // first hint available after 30s
  nextHintAt = Date.now() + 30000;
  updateHintButton();
}
function updateHintButton(){
  const b = $("#btn-hint");
  const hs = $("#hint-status");
  function tick(){
    const now = Date.now();
    if(revealedHints >= 3){
      b.disabled = true;
      b.textContent = "No more hints";
      hs.textContent = "Hints: none left";
      return;
    }
    const left = nextHintAt - now;
    if(left <= 0){
      b.disabled = false;
      b.textContent = "Reveal hint";
      hs.textContent = "Hint ready";
    }else{
      b.disabled = true;
      b.textContent = "Reveal hint";
      hs.textContent = "Hint available in " + fmt(left);
      requestAnimationFrame(tick);
    }
  }
  tick();
}
function revealNextHint(){
  // respect cooldown and cap
  if(Date.now() < nextHintAt) return;
  const next = document.querySelector(".hint.hidden");
  if(!next) { updateHintButton(); return; }
  next.classList.remove("hidden");
  revealedHints++;
  // next hint after 30s
  nextHintAt = Date.now() + 30000;
  updateHintButton();
}

/* ===== RENDER QUESTION ===== */
function render(){
  setProgress();
  const q = QUESTIONS[idx];
  $("#qimg").src = q.image;
  $("#qimg").alt = q.title;
  $("#qtitle").textContent = q.title;
  $("#qtext").textContent = q.text;
  $("#options").innerHTML = "";
  $("#status").textContent = "Pick an answer";
  $("#btn-next").disabled = true;
  $("#lockmsg").style.display = "none";
  resetHints();
  sectionStart = performance.now();
  $("#section-timer").textContent = "00:00";
  // Build options
  q.options.forEach((t,i)=>{
    const label = el("label","opt");
    const input = el("input"); input.type="radio"; input.name="opt"; input.value=i;
    const span = el("span"); span.textContent = t;
    label.appendChild(input); label.appendChild(span);
    label.addEventListener("click", (ev)=>{
      const now = Date.now();
      if(now < lockedUntil){
        ev.preventDefault();
        return;
      }
      const correct = (i === q.correct);
      $("#status").textContent = correct ? "Correct!" : "Wrong ‚Äî locked 30s";
      if(correct){
        $("#btn-next").disabled = false;
      }else{
        lockedUntil = now + 30000;
        $("#lockmsg").style.display = "inline";
        startLockCountdown();
      }
    });
    $("#options").appendChild(label);
  });
}
function startLockCountdown(){
  const msg = $("#lockmsg");
  function tick(){
    const left = Math.max(0, lockedUntil - Date.now());
    if(left <= 0){
      msg.style.display = "none";
      $("#status").textContent = "Pick an answer";
      return;
    }
    msg.textContent = `Locked for ${Math.ceil(left/1000)}s after a wrong answer`;
    requestAnimationFrame(tick);
  }
  tick();
}

/* ===== NAV ===== */
function startGame(){
  $("#screen-start").style.display = "none";
  $("#screen-quiz").style.display = "grid";
  idx = 0; lockedUntil = 0;
  totalStart = performance.now();
  render();
  if(rafId) cancelAnimationFrame(rafId);
  (function ttick(){
    const elapsed = performance.now() - totalStart;
    const remain = Math.max(0, 10*60*1000 - elapsed);
    document.querySelector("header .timer").textContent = "Time: " + fmt(remain);
    $("#section-timer").textContent = fmt(performance.now() - sectionStart);
    rafId = requestAnimationFrame(ttick);
  })();
}
function next(){
  idx++;
  if(idx >= QUESTIONS.length){
    finish();
  }else{
    lockedUntil = 0;
    render();
  }
}
function finish(){
  $("#screen-quiz").style.display = "none";
  $("#screen-end").style.display = "block";
  confetti();
}

/* ===== CONFETTI ===== */
function confetti(){
  const colors = ["#006a44","#fdb913","#c1272d","#ffffff","#60a5fa"];
  const N = 120;
  for(let i=0;i<N;i++){
    const d = document.createElement("div");
    d.className="confetti";
    d.style.left = Math.random()*100+"%";
    d.style.background = colors[Math.floor(Math.random()*colors.length)];
    d.style.animationDuration = (1.5+Math.random()*2.2)+"s";
    d.style.animationDelay = (Math.random()*0.5)+"s";
    d.style.opacity = 0.7 + Math.random()*0.3;
    document.body.appendChild(d);
    setTimeout(()=>d.remove(), 3500);
  }
}

/* ===== EVENTS ===== */
document.getElementById("btn-start").addEventListener("click", startGame);
document.getElementById("btn-next").addEventListener("click", next);
document.getElementById("btn-hint").addEventListener("click", revealNextHint);
document.getElementById("btn-restart").addEventListener("click", ()=>{
  $("#screen-end").style.display = "none";
  $("#screen-start").style.display = "block";
});
document.getElementById("btn-celebrate").addEventListener("click", confetti);
</script>
</body>
</html>
